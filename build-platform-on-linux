#!/bin/bash
PLATFORM=$1
BUILD_TESTS=$2
BUILD_SHARED_LIBS=$3
BUILD_STATIC_LIBS=$4
TOOLCHAIN_FILE=$5
VERSION=$(<version)

BUILD_DIR=cmake-build-$PLATFORM
rm -r -f $BUILD_DIR
mkdir $BUILD_DIR
cd $BUILD_DIR

cmake \
-DCMAKE_BUILD_TYPE=Release \
-DCMAKE_TOOLCHAIN_FILE=$TOOLCHAIN_FILE \
-DBUILD_TESTS=$BUILD_TESTS \
-DBUILD_SHARED_LIBS=$BUILD_SHARED_LIBS \
-DBUILD_STATIC_LIBS=$BUILD_STATIC_LIBS \
..

make

../copy-to-output-on-linux . ../output $PLATFORM $VERSION

cd ..
